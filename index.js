(function(){"use strict";var _=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("k-inside",{staticClass:"k-responsive-images-panel",scopedSlots:e._u([{key:"footer",fn:function(){return[e.hasChanges?t("nav",{staticClass:"k-form-buttons",attrs:{"data-theme":"notice"}},[t("k-view",[t("k-button",{staticClass:"k-form-button",attrs:{icon:"undo",type:"button"},on:{click:e.reset}},[e._v(" "+e._s(e.$t("nerdcel.responsive-images.undo"))+" ")]),t("k-button",{staticClass:"k-form-button",attrs:{icon:"check",type:"button"},on:{click:e.submit}},[e._v(" "+e._s(e.$t("nerdcel.responsive-images.save"))+" ")])],1)],1):e._e()]},proxy:!0}])},[t("k-view",[t("k-header",[t("h2",[e._v(e._s(e.$t("nerdcel.responsive-images.title")))])])],1),t("k-view",[t("k-grid",{attrs:{gutter:"medium"}},[t("k-column",{attrs:{width:"1/3"}},[t("div",{staticClass:"k-section k-responsive-images-breakpoints"},[t("k-structure-field",{attrs:{columns:e.columnsBreakpoints,required:!0,label:e.$t("nerdcel.responsive-images.breakpoints"),name:"responsivebreakpoints",help:e.$t("nerdcel.responsive-images.breakpointsinfo"),fields:e.fieldsBreakpoints,endpoints:e.endpointsBreakpoints,duplicate:!1},on:{input:e.input},model:{value:e.responsivebreakpointsModel,callback:function(o){e.responsivebreakpointsModel=o},expression:"responsivebreakpointsModel"}})],1)]),t("k-column",{attrs:{width:"2/3"}},[t("div",{staticClass:"k-section"},[t("k-info-field",{attrs:{label:e.$t("nerdcel.responsive-images.info"),text:"responsiveImage('key-settings', $image, $optionalClasses)"}})],1),t("div",{staticClass:"k-section k-responsive-images-view"},[t("k-structure-field",{attrs:{disabled:!this.breakpoints.length,columns:e.columns,required:!0,label:e.$t("nerdcel.responsive-images.settings"),name:"responsivesettings",help:e.$t("nerdcel.responsive-images.info"),fields:e.fields,endpoints:e.endpoints,duplicate:!1},on:{input:e.input},model:{value:e.responsivesettingsModel,callback:function(o){e.responsivesettingsModel=o},expression:"responsivesettingsModel"}})],1)])],1)],1)],1)},m=[],X="";function l(e,s,t,o,a,h,v,I){var i=typeof e=="function"?e.options:e;s&&(i.render=s,i.staticRenderFns=t,i._compiled=!0),o&&(i.functional=!0),h&&(i._scopeId="data-v-"+h);var r;if(v?(r=function(n){n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!n&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(n=__VUE_SSR_CONTEXT__),a&&a.call(this,n),n&&n._registeredComponents&&n._registeredComponents.add(v)},i._ssrRegister=r):a&&(r=I?function(){a.call(this,(i.functional?this.parent:this).$root.$options.shadowRoot)}:a),r)if(i.functional){i._injectStyles=r;var U=i.render;i.render=function(V,g){return r.call(g),U(V,g)}}else{var f=i.beforeCreate;i.beforeCreate=f?[].concat(f,r):[r]}return{exports:e,options:i}}const b={data(){return{ready:!1,columns:{name:{label:"Name",type:"text",width:"1/4"},breakpointoptions:{label:"Settings",type:"settings",width:"3/4"}},columnsBreakpoints:{mediaquery:{label:"Mediaquery",type:"select"},name:{label:"Name",type:"text"},width:{label:"Width",type:"number",after:"px"}},endpoints:{field:"responsive-images",section:"responsive-images",model:"responsive-images"},endpointsBreakpoints:{field:"responsive-images-breakpoints",section:"responsive-images-breakpoints",model:"responsive-images-breakpoints"},responsivesettingsModel:[],responsivebreakpointsModel:[],hasChanges:!1}},props:{config:{type:Object,default:()=>({breakpoints:[],settings:[]})}},created(){this.$events.$on("keydown.cmd.s",this.submit)},destroyed(){this.$events.$off("keydown.cmd.s",this.submit)},mounted(){this.responsivesettingsModel=Object.assign([],this.settings),this.responsivebreakpointsModel=Object.assign([],this.breakpoints),this.$nextTick(()=>this.ready=!0)},computed:{fields(){return{name:{label:"Name",type:"slug",required:!0},breakpointoptions:{label:"Options",type:"structure",columns:{breakpoint:{type:"select",label:"Name",required:!0},width:{type:"number",label:"Width",default:null,after:"px"},cropwidth:{type:"toggle",default:!1,label:"Crop width"},height:{type:"number",label:"Height",default:null,after:"px"},cropheight:{type:"toggle",default:!1,label:"Crop height"},retina:{type:"toggle",default:!0,label:"Retina"}},fields:{breakpoint:{label:"Breakpoint",type:"select",options:this.breakpointOptions,width:"1/6"},width:{label:"Width",type:"number",min:0,width:"1/6"},cropwidth:{label:"Crop width",type:"toggle",default:0,width:"1/6"},height:{label:"Height",type:"number",min:0,width:"1/6"},cropheight:{label:"Crop height",type:"toggle",default:0,width:"1/6"},retina:{label:"Retina support",type:"toggle",default:!0,width:"1/6"}}}}},breakpointOptions(){return this.breakpoints.map(s=>Object.assign({},{text:s.name,value:s.name}))},fieldsBreakpoints(){return{mediaquery:{label:"Mediaquery",type:"select",default:"min-width",options:[{text:"Min width",value:"min-width"},{text:"Max width",value:"max-width"}]},name:{label:"Name",type:"text"},width:{label:"Width",type:"number",after:"px"}}},settings(){return this.config&&this.config.hasOwnProperty("settings")?this.config.settings:[]},breakpoints(){return this.config&&this.config.hasOwnProperty("breakpoints")?this.config.breakpoints:[]}},methods:{async submit(e){e&&e.preventDefault(),await this.$api.post(this.endpoints.field,{breakpoints:this.responsivebreakpointsModel,settings:this.responsivesettingsModel}),this.$reload(),this.hasChanges=!1},reset(){this.responsivesettingsModel=Object.assign([],this.settings),this.responsivebreakpointsModel=Object.assign([],this.breakpoints),this.hasChanges=!1},input(){return this.ready&&(JSON.stringify(this.settings)!==JSON.stringify(this.responsivesettingsModel)||JSON.stringify(this.breakpoints)!==JSON.stringify(this.responsivebreakpointsModel))?this.hasChanges=!0:this.hasChanges=!1}}},p={};var k=l(b,_,m,!1,y,null,null,null);function y(e){for(let s in p)this[s]=p[s]}var $=function(){return k.exports}(),w=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"k-settings-preview-field"},[t("k-table",{attrs:{empty:"\u2014",columns:{breakpoint:{label:"Breakpoint",type:"text"},width:{label:"Width",type:"number",after:"px"},cropwidth:{label:"Crop?",type:"toggle-extend"},height:{label:"Height",type:"number",after:"px"},cropheight:{label:"Crop?",type:"toggle-extend"},retina:{label:"Retina?",type:"toggle-extend"}},rows:e.value}})],1)},C=[];const x={props:{value:String,column:Object,field:Object}},d={};var M=l(x,w,C,!1,O,null,null,null);function O(e){for(let s in d)this[s]=d[s]}var R=function(){return M.exports}(),S=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"k-toggle-extend-preview-field"},[t("k-text-field-preview",[e._v(e._s(e.value?"\u2713":"\u2A2F"))])],1)},j=[];const N={props:{value:String,column:Object,field:Object}},u={};var q=l(N,S,j,!1,B,null,null,null);function B(e){for(let s in u)this[s]=u[s]}var F=function(){return q.exports}(),E=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("k-inside",{staticClass:"k-responsive-images-panel"},[t("k-view",[t("k-header",[t("h2",[e._v(e._s(e.$t("nerdcel.responsive-images.restricted.title")))])]),t("p",[e._v(" "+e._s(e.$t("nerdcel.responsive-images.restricted.text"))+" ")])],1)],1)},T=[];const W={},c={};var J=l(W,E,T,!1,P,null,null,null);function P(e){for(let s in c)this[s]=c[s]}var H=function(){return J.exports}();window.panel.plugin("nerdcel/kirby3-responsive-images",{components:{"k-nerdcel-responsive-images":$,"k-nerdcel-restricted":H,"k-settings-field-preview":R,"k-toggle-extend-field-preview":F}})})();
